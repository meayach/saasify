<!DOCTYPE html>
<html>
  <head>
    <title>Test Plan Selection Workflow</title>
  </head>
  <body>
    <h1>Test du Workflow de Sélection de Plan</h1>

    <h2>1. Simuler la sélection d'un plan</h2>
    <button onclick="simulatePlanSelection()">
      Simuler sélection Plan Enterprise
    </button>

    <h2>2. Naviguer vers la configuration d'application</h2>
    <button onclick="navigateToConfiguration()">
      Aller à la configuration
    </button>

    <h2>3. État du localStorage</h2>
    <div id="localStorageStatus"></div>
    <button onclick="checkLocalStorage()">Vérifier localStorage</button>
    <button onclick="clearLocalStorage()">Nettoyer localStorage</button>

    <script>
      function simulatePlanSelection() {
        const plan = {
          id: "68bf677bdf8ea2b424543a03",
          name: "Plan Enterprise",
          description: "Plan complet pour les grandes organisations",
          type: "ENTERPRISE",
          billingCycle: "MONTHLY",
          price: 99.99,
          currency: "EUR",
          isActive: true,
          isPopular: false,
          includedFeatures: [
            "Fonctionnalité A",
            "Fonctionnalité B",
            "Support 24/7",
          ],
          createdAt: "2025-09-08T23:32:11.549Z",
          updatedAt: "2025-09-08T23:32:11.549Z",
        };

        localStorage.setItem("selectedPlan", JSON.stringify(plan));
        localStorage.setItem(
          "selectedApplicationId",
          "68a87801a0fc8740c837946c"
        );

        alert("Plan sélectionné simulé avec succès !");
        checkLocalStorage();
      }

      function navigateToConfiguration() {
        const applicationId = "68a87801a0fc8740c837946c";
        window.location.href = `http://localhost:4201/applications/configure/${applicationId}`;
      }

      function checkLocalStorage() {
        const selectedPlan = localStorage.getItem("selectedPlan");
        const selectedApplicationId = localStorage.getItem(
          "selectedApplicationId"
        );

        document.getElementById("localStorageStatus").innerHTML = `
                <h3>État localStorage:</h3>
                <p><strong>selectedPlan:</strong> ${
                  selectedPlan ? "Présent" : "Absent"
                }</p>
                <p><strong>selectedApplicationId:</strong> ${
                  selectedApplicationId || "Absent"
                }</p>
                ${
                  selectedPlan
                    ? "<pre>" +
                      JSON.stringify(JSON.parse(selectedPlan), null, 2) +
                      "</pre>"
                    : ""
                }
            `;
      }

      function clearLocalStorage() {
        localStorage.removeItem("selectedPlan");
        localStorage.removeItem("selectedApplicationId");
        alert("localStorage nettoyé !");
        checkLocalStorage();
      }

      // Vérifier le localStorage au chargement
      window.onload = function () {
        checkLocalStorage();
      };
    </script>
  </body>
</html>
