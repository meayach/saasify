<div class="application-list-container">
  <!-- Header avec breadcrumbs -->
  <div class="header">
    <div class="breadcrumbs">
      <span class="breadcrumb-item" (click)="router.navigate(['/dashboard'])">Dashboard</span>
      <span class="breadcrumb-separator">></span>
      <span class="breadcrumb-current">Gestion des Applications</span>
    </div>
    <h1>Gestion des Applications</h1>
    <p class="subtitle">Gérez et surveillez toutes vos applications SaaS</p>
  </div>

  <!-- Statistiques -->
  <div class="stats-row">
    <div class="stat-card">
      <div class="stat-icon">
        <i class="pi pi-th-large"></i>
      </div>
      <div class="stat-content">
        <h3>{{ applicationStats.totalApplications }}</h3>
        <p>Total Applications</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">
        <i class="pi pi-check-circle"></i>
      </div>
      <div class="stat-content">
        <h3>{{ applicationStats.activeApplications }}</h3>
        <p>Applications Actives</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">
        <i class="pi pi-upload"></i>
      </div>
      <div class="stat-content">
        <h3>{{ applicationStats.deploymentsToday }}</h3>
        <p>Déploiements Aujourd'hui</p>
      </div>
    </div>
  </div>

  <!-- Actions -->
  <div class="actions-bar">
    <button class="btn-primary" (click)="createNewApplication()">
      <i class="pi pi-plus"></i>
      Nouvelle Application
    </button>
    <button class="btn-secondary" (click)="refreshData()" [disabled]="loading">
      <i class="pi pi-refresh" [class.pi-spin]="loading"></i>
      {{ loading ? 'Actualisation...' : 'Actualiser' }}
    </button>
  </div>

  <!-- Liste des applications -->
  <div class="applications-grid" *ngIf="!loading">
    <div
      class="application-card"
      *ngFor="let app of applications; trackBy: trackByFn; let i = index">
      <div class="card-header">
        <div class="app-info">
          <h3>{{ app.name }}</h3>
        </div>
        <div class="app-toggle">
          <div class="toggle-switch">
            <div
              class="manual-toggle"
              [class.active]="applications[i].isActive"
              (click)="simpleToggle(i)"
              [style.background]="applications[i].isActive ? '#4CAF50' : '#ccc'"
              style="
                width: 50px;
                height: 25px;
                border-radius: 25px;
                position: relative;
                cursor: pointer;
                transition: all 0.3s;
              ">
              <div
                class="toggle-circle"
                [style.left]="applications[i].isActive ? '27px' : '2px'"
                style="
                  width: 21px;
                  height: 21px;
                  background: white;
                  border-radius: 50%;
                  position: absolute;
                  top: 2px;
                  transition: all 0.3s;
                "></div>
            </div>
          </div>
          <span class="toggle-label">
            {{ applications[i].isActive ? 'Actif' : 'Inactif' }}
          </span>
        </div>
      </div>

      <div class="card-content">
        <div class="metadata">
          <span class="created-date">
            <i class="pi pi-calendar"></i>
            Créé le {{ app.createdAt | date : 'dd/MM/yyyy' }}
          </span>
        </div>
      </div>

      <div class="card-actions">
        <button class="btn-configure" (click)="configureApplication(app._id!)">
          <i class="pi pi-cog"></i>
          Configurer
        </button>
        <button class="btn-delete" (click)="deleteApplication(app._id!)">
          <div class="trash-icon">
            <i class="pi pi-trash"></i>
          </div>
        </button>
      </div>
    </div>
  </div>

  <!-- Loading state -->
  <div class="loading-container" *ngIf="loading">
    <div class="loading-spinner">
      <i class="pi pi-spinner pi-spin"></i>
      <p>Chargement des applications...</p>
    </div>
  </div>

  <!-- Empty state -->
  <div class="empty-state" *ngIf="!loading && applications.length === 0">
    <div class="empty-icon"><i class="pi pi-mobile"></i></div>
    <h3>Aucune application trouvée</h3>
    <p>Commencez par créer votre première application</p>
    <button class="btn-primary" (click)="createNewApplication()">
      <i class="pi pi-plus"></i>
      Créer ma première application
    </button>
  </div>
</div>

<!-- Modal de confirmation -->
<app-confirmation-modal></app-confirmation-modal>
